{% extends "blogs/base.html" %}

{% block title %}
  {{ ficha_tecnica.nome }} | Blog do Projeto | Luiz R. Dererita
{% endblock %}

{% block styles %}
  /* === Reset e Base === */
  body {
    background-color: #0d0d0d;
    color: #f1f1f1;
    font-family: 'Segoe UI', system-ui, sans-serif;
    padding-top: 56px;
  }

  [id] {
    scroll-margin-top: 70px;
  }


  /* === Capa do Blog === */
  .blog-cover {
    position: relative;
    height: 250px;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    background-color: #000;
  }

  .banner-fundo {
    position: absolute;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 1;
  }

  .logo-central, .titulo-projeto {
    position: relative;
    z-index: 2;
  }

  .logo-central {
    max-height: 80%;
    max-width: 80%;
    filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.7));
  }

  .titulo-projeto {
    font-size: 2.5rem;
    color: white;
    text-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
    text-align: center;
  }


  /* === Menu de Se√ß√µes === */
  .section-nav {
    background: linear-gradient(to right, #101010, #0d0d0d);
    border-top: 1px solid #333;
    border-bottom: 1px solid #333;
    padding: 0.5rem 0;
    margin-bottom: 2rem;
    position: sticky;
    top: 56px;
    z-index: 100;
  }

  .nav-section-link {
    color: #ccc;
    text-decoration: none;
    padding: 0.5rem 1rem;
    margin: 0 0.25rem;
    font-weight: 500;
    font-size: 0.95rem;
    border-radius: 8px;
    transition: all 0.2s ease-in-out;
  }

  .nav-section-link:hover,
  .nav-section-link.active {
    background-color: #5ec1ff20;
    color: #5ec1ff;
  }


  /* === T√≠tulos === */
  .section-title {
    font-weight: bold;
    border-bottom: 2px solid #5ec1ff;
    display: inline-block;
    padding-bottom: 5px;
  }


  /* === Metainforma√ß√µes === */
  .meta-info {
    font-size: 0.9rem;
    color: #bbb;
  }


  /* === Sidebar === */
  .sidebar {
    background-color: #1a1a1a;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 2rem;
  }

  .sidebar h4 {
    color: #5ec1ff;
  }

  .sidebar ul {
    list-style: none;
    padding-left: 0;
  }

  .sidebar ul li {
    margin-bottom: 10px;
  }

  .sidebar ul li a {
    color: #ccc;
    text-decoration: none;
  }

  .sidebar ul li a:hover {
    color: #fff;
  }


  /* === Separadores === */
  .post-separator {
    border-top: 2px solid #333;
    margin: 60px 0 40px;
  }

  main > *:not(:last-child) {
    margin-bottom: 2.5rem;
  }


  /* === Imagens de Post === */
  .preview-img-wrapper {
    display: none;
  }

  .preview-img,
  .preview-img-fluid {
    display: block;
    width: 100%;
    height: auto;
    object-fit: contain;
    padding: 25px;
    border: 1px solid #444;
    border-radius: 8px;
    margin-bottom: 1rem;
  }


  /* === Metadados dos Posts === */
  .post-meta {
    display: flex;
    gap: 1.5rem;
    align-items: center;
    font-size: 0.9rem;
    color: #ccc;
    margin-top: 0.75rem;
  }

  .post-meta span {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .post-meta i {
    font-size: 1rem;
    color: #aaa;
    transition: color 0.2s ease;
  }


  /* === Separador das Previews === */
  .preview-separator {
    border-top: 1px solid #333;
    margin: 0.75rem 0 1rem;
  }


  /* === √çcone de Compartilhamento === */
  .share-icon-top {
    position: absolute;
    top: 12px;
    right: 12px;
    font-size: 1.1rem;
    color: #bbb;
    padding: 6px;
    border-radius: 50%;
    transition: all 0.2s ease-in-out;
  }

  .share-icon-top:hover {
    color: #5ec1ff;
    background-color: #222;
  }


  /* === Disqus: Contador formatado com √≠cone === */
  .disqus-comment-count {
    display: inline-flex;
    align-items: center;
    color: #ccc;
    text-decoration: none;
    font-size: 0.9rem;
  }

  .disqus-comment-count:hover {
    color: #5ec1ff;
  }

  .disqus-comment-count::before {
    content: "\f075"; /* Font Awesome fa-comment */
    font-family: "Font Awesome 6 Free";
    font-weight: 400;
    margin-right: 6px;
    font-size: 1rem;
  }


  /* Ocultar os links do Disqus usados s√≥ como fonte */
  .disqus-comment-count.d-none {
    display: none !important;
  }


  /* === Pagina√ß√£o === */
  .blog-pagination {
    margin-top: 40px;
  }

  .page-link.custom-page-link {
    background-color: #1a1a1a;
    color: #ccc;
    border: 1px solid #444;
    border-radius: 6px;
    padding: 6px 12px;
    margin: 0 4px;
    transition: all 0.2s ease-in-out;
  }

  .page-link.custom-page-link:hover {
    background-color: #5ec1ff20;
    color: #5ec1ff;
    border-color: #5ec1ff;
  }

  .page-item.active .custom-page-link {
    background-color: #5ec1ff;
    color: #0d0d0d;
    border-color: #5ec1ff;
    font-weight: bold;
  }


  /* === Rodap√© === */
  footer {
    background-color: #111;
    color: #bbb;
    margin-top: 60px;
  }


  /* === Responsividade === */
  @media (max-width: 768px) {
    .blog-title-overlay {
      font-size: 1.8rem;
    }
  }

  @media (max-width: 576px) {
    #contato ul.list-inline {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    #contato ul.list-inline li,
    #contato ul.list-inline a.btn {
      width: 100%;
      text-align: center;
    }
  }

{% endblock %}

{% block content %}
<!-- Se√ß√£o de Postagens -->
<h2 class="section-title mt-4" id="postagens">Novidades</h2>

{% for post in posts %}
  <div class="card bg-dark text-white mb-4">
    <div class="card-body position-relative">

      <!-- √çcone de Compartilhamento -->
      <a href="#" class="share-icon-top" title="Compartilhar este post">
        <i class="fas fa-share-nodes"></i>
      </a>

      <h5 class="card-title">{{ post.titulo }}</h5>
      <p class="meta-info post-data">
        Postado em <strong>{{ post.data|data_extensa }}</strong> por <strong>{{ post.autor }}</strong>
      </p>

      <div class="preview-separator"></div>

      {% if post.imagem %}
        <img src="{{ url_for('static', filename=post.imagem) }}"
             alt="Preview de {{ post.titulo }}"
             class="preview-img-fluid">
      {% endif %}

      <p class="card-text mt-3">
        {{ post.conteudo|striptags|truncate(500, True, '...') }}
      </p>

      <a href="{{ url_for('ver_post', projeto=projeto, nome=post.nome_arquivo) }}"
         class="btn btn-outline-light btn-sm">
        Ler mais
      </a>

    <div class="preview-separator"></div>

    <div class="post-meta d-flex justify-content-start align-items-center gap-4 mt-2">
      <!-- Visualiza√ß√µes -->
      <span><i class="far fa-eye"></i> {{ post.visualizacoes or 0 }}</span>
      <!-- Coment√°rios -->
      <span><i class="far fa-comment"></i> <span id="contador-{{ post.nome_arquivo }}">0</span></span>
      <!-- Disqus contador invis√≠vel para pegar os dados -->
      <a href="{{ url_for('ver_post', projeto=projeto, nome=post.nome_arquivo) }}#disqus_thread"
        class="disqus-comment-count d-none"
        data-disqus-identifier="{{ projeto }}/{{ post.nome_arquivo }}">
        0
      </a>
    </div>

    </div>
  </div>
{% endfor %}

<!-- Pagina√ß√£o -->
{% if total_paginas > 1 %}
  <nav>
    <ul class="pagination justify-content-center">
      <!-- P√°gina Anterior -->
      <li class="page-item {% if pagina_atual == 1 %}disabled{% endif %}">
        <a class="page-link custom-page-link"
           href="{{ url_for('blog_index', projeto=projeto, pagina=pagina_atual - 1) }}">
          Anterior
        </a>
      </li>

      <!-- N√∫meros de P√°gina -->
      {% for pagina in range(1, total_paginas + 1) %}
        <li class="page-item {% if pagina == pagina_atual %}active{% endif %}">
          <a class="page-link custom-page-link"
             href="{{ url_for('blog_index', projeto=projeto, pagina=pagina) }}">
            {{ pagina }}
          </a>
        </li>
      {% endfor %}

      <!-- P√°gina Seguinte -->
      <li class="page-item {% if pagina_atual == total_paginas %}disabled{% endif %}">
        <a class="page-link custom-page-link"
           href="{{ url_for('blog_index', projeto=projeto, pagina=pagina_atual + 1) }}">
          Pr√≥xima
        </a>
      </li>
    </ul>
  </nav>
{% endif %}

<div class="post-separator"></div>

<!-- C√≥digo Fonte -->
<h2 class="section-title mt-4" id="codigo-fonte">üîó C√≥digo Fonte</h2>
<p>Voc√™ pode acessar o c√≥digo fonte do projeto no GitHub atrav√©s do bot√£o abaixo:</p>
<div class="my-4">
  <a href="https://github.com/LuizRaizen/{{ projeto | replace(' ', '_') | lower }}"
     class="btn btn-outline-light btn-lg" target="_blank">
    <i class="fab fa-github"></i> Ver C√≥digo no GitHub
  </a>
</div>

<div class="post-separator"></div>

<!-- Ficha T√©cnica -->
<h2 class="section-title mt-4" id="ficha-tecnica">üîß Ficha T√©cnica</h2>
<ul>
  {% if ficha_tecnica.linguagem %}
    <li><strong>Linguagem principal:</strong> {{ ficha_tecnica.linguagem }}</li>
  {% endif %}
  {% if ficha_tecnica.framework %}
    <li><strong>Framework:</strong> {{ ficha_tecnica.framework }}</li>
  {% endif %}
  {% if ficha_tecnica.paradigma %}
    <li><strong>Paradigma:</strong> {{ ficha_tecnica.paradigma }}</li>
  {% endif %}
  {% if ficha_tecnica.arquitetura %}
    <li><strong>Arquitetura:</strong> {{ ficha_tecnica.arquitetura }}</li>
  {% endif %}
  {% if ficha_tecnica.tipo_projeto %}
    <li><strong>Tipo de Projeto:</strong> {{ ficha_tecnica.tipo_projeto }}</li>
  {% endif %}
  {% if ficha_tecnica.interface %}
    <li><strong>Interface:</strong> {{ ficha_tecnica.interface }}</li>
  {% endif %}
  {% if ficha_tecnica.funcionalidades %}
    <li><strong>Funcionalidades:</strong>
      <ul>
        {% for item in ficha_tecnica.funcionalidades %}
          <li>{{ item }}</li>
        {% endfor %}
      </ul>
    </li>
  {% endif %}
  {% if ficha_tecnica.bibliotecas %}
    <li><strong>Bibliotecas Utilizadas:</strong> {{ ficha_tecnica.bibliotecas | join(', ') }}</li>
  {% endif %}
  {% if ficha_tecnica.banco_de_dados %}
    <li><strong>Banco de Dados:</strong> {{ ficha_tecnica.banco_de_dados }}</li>
  {% endif %}
  {% if ficha_tecnica.api_externa %}
    <li><strong>APIs Externas:</strong> {{ ficha_tecnica.api_externa }}</li>
  {% endif %}
  {% if ficha_tecnica.plataforma %}
    <li><strong>Plataforma Alvo:</strong> {{ ficha_tecnica.plataforma }}</li>
  {% endif %}
  {% if ficha_tecnica.resolucao %}
    <li><strong>Resolu√ß√£o Padr√£o:</strong> {{ ficha_tecnica.resolucao }}</li>
  {% endif %}
  {% if ficha_tecnica.status %}
    <li><strong>Status do Projeto:</strong> {{ ficha_tecnica.status }}</li>
  {% endif %}
</ul>

<!-- Roadmap -->
{% set status_icons = {
  "concluido": "fas fa-check-circle text-success",
  "desenvolvimento": "fas fa-spinner text-warning",
  "planejado": "far fa-circle text-secondary"
} %}

{% if roadmap %}
  {% set alerta = roadmap[0]['alerta'] if 'alerta' in roadmap[0] else None %}
  {% set metas = roadmap[1:] if alerta else roadmap %}

  {% if metas %}
    <div class="post-separator"></div>

    <h2 class="section-title mt-4" id="roadmap">üìå Roadmap do Projeto</h2>

    {% if alerta %}
      <p class="text-warning mt-3">
        <i class="fas fa-exclamation-triangle me-2"></i> {{ alerta }}
      </p>
    {% endif %}

    <ul class="list-unstyled">
      {% for item in metas %}
        <li><i class="{{ status_icons[item.status] }} me-2"></i>{{ item.meta }}</li>
      {% endfor %}
    </ul>
  {% endif %}

  <!-- Legenda -->
  <h5 class="mt-4">Legenda:</h5>
  <ul class="list-inline">
    {% for key, icon in status_icons.items() %}
      <li class="list-inline-item me-3">
        <i class="{{ icon }}"></i> {{ key.capitalize() }}
      </li>
    {% endfor %}
  </ul>
{% endif %}
{% endblock %}
